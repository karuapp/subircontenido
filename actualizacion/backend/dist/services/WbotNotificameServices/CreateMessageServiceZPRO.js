'use strict';
const _0x6ffcab = _0x41cb;
(function (_0x58f25f, _0x5e9bba) {
    const _0x3a53d6 = _0x41cb, _0x5543eb = _0x58f25f();
    while (!![]) {
        try {
            const _0x5b9b42 = -parseInt(_0x3a53d6(0x10b)) / (0x190d + 0x50 + -0x1 * 0x195c) * (-parseInt(_0x3a53d6(0x150)) / (0x11b * 0x21 + -0x1fb2 + 0x4c7 * -0x1)) + -parseInt(_0x3a53d6(0x100)) / (-0x1154 + 0x101a + 0x13d * 0x1) + -parseInt(_0x3a53d6(0xfd)) / (-0x239f + 0xfe2 + 0x1 * 0x13c1) + parseInt(_0x3a53d6(0x101)) / (0x2 * 0xfde + -0x2 * -0x12df + -0x4575) + -parseInt(_0x3a53d6(0x10a)) / (0x43 * 0x33 + 0x25b + 0x7d7 * -0x2) + -parseInt(_0x3a53d6(0x156)) / (-0x1e77 + 0x3 * 0x163 + -0x6b * -0x3f) * (-parseInt(_0x3a53d6(0x111)) / (0x215f + 0x13a * 0x1d + 0x2ff * -0x17)) + parseInt(_0x3a53d6(0x14b)) / (-0x5bd + -0x1 * 0x395 + 0x95b) * (parseInt(_0x3a53d6(0x103)) / (0x202 * -0x9 + -0xf9 + 0x1 * 0x1315));
            if (_0x5b9b42 === _0x5e9bba)
                break;
            else
                _0x5543eb['push'](_0x5543eb['shift']());
        } catch (_0xf5030) {
            _0x5543eb['push'](_0x5543eb['shift']());
        }
    }
}(_0x2a7d, 0x7668c + -0x16c05f + -0x9a45d * -0x3));
function _0x41cb(_0x2d7ee0, _0x4b0437) {
    const _0x3e460c = _0x2a7d();
    return _0x41cb = function (_0x1c0014, _0x3613d5) {
        _0x1c0014 = _0x1c0014 - (-0x36e + 0x5 * 0x31d + -0xb40);
        let _0x221119 = _0x3e460c[_0x1c0014];
        return _0x221119;
    }, _0x41cb(_0x2d7ee0, _0x4b0437);
}
var __awaiter = this && this[_0x6ffcab(0x12c)] || function (_0x6f19e1, _0x4d6ab9, _0x5556ff, _0x354243) {
        const _0x1a10ca = _0x6ffcab, _0x2adbc2 = {
                'Fsaum': function (_0x123b95, _0x390c1b) {
                    return _0x123b95(_0x390c1b);
                },
                'IqHAl': function (_0x41a4cd, _0x4d1b8c) {
                    return _0x41a4cd instanceof _0x4d1b8c;
                },
                'NvypO': _0x1a10ca(0x14a),
                'tnUxE': function (_0x6192ab, _0x1a42fb) {
                    return _0x6192ab(_0x1a42fb);
                }
            };
        function _0x4e203c(_0x333d00) {
            const _0x54a7be = _0x1a10ca, _0x5641c8 = {
                    'nJYIc': function (_0x19d44b, _0x4aabba) {
                        const _0x4b0e59 = _0x41cb;
                        return _0x2adbc2[_0x4b0e59(0x121)](_0x19d44b, _0x4aabba);
                    }
                };
            return _0x2adbc2[_0x54a7be(0x13b)](_0x333d00, _0x5556ff) ? _0x333d00 : new _0x5556ff(function (_0x1b7ace) {
                const _0x16a027 = _0x54a7be;
                _0x5641c8[_0x16a027(0x11d)](_0x1b7ace, _0x333d00);
            });
        }
        return new (_0x5556ff || (_0x5556ff = Promise))(function (_0x30e9c8, _0x579392) {
            const _0x58251f = _0x1a10ca, _0x394352 = {
                    'BKOeK': function (_0x4a4d7b, _0x284139) {
                        const _0x17e30f = _0x41cb;
                        return _0x2adbc2[_0x17e30f(0x121)](_0x4a4d7b, _0x284139);
                    },
                    'CyltF': _0x2adbc2[_0x58251f(0x12f)]
                };
            function _0xb6217(_0x7ecfae) {
                const _0x201fa8 = _0x58251f;
                try {
                    _0x394352[_0x201fa8(0xea)](_0x57298e, _0x354243[_0x201fa8(0x110)](_0x7ecfae));
                } catch (_0x58ad0f) {
                    _0x394352[_0x201fa8(0xea)](_0x579392, _0x58ad0f);
                }
            }
            function _0x215ef0(_0x48b404) {
                const _0x5c49bd = _0x58251f;
                try {
                    _0x394352[_0x5c49bd(0xea)](_0x57298e, _0x354243[_0x394352[_0x5c49bd(0x155)]](_0x48b404));
                } catch (_0x244da9) {
                    _0x394352[_0x5c49bd(0xea)](_0x579392, _0x244da9);
                }
            }
            function _0x57298e(_0xe42279) {
                const _0x5676f1 = _0x58251f;
                _0xe42279[_0x5676f1(0xef)] ? _0x394352[_0x5676f1(0xea)](_0x30e9c8, _0xe42279[_0x5676f1(0x131)]) : _0x394352[_0x5676f1(0xea)](_0x4e203c, _0xe42279[_0x5676f1(0x131)])[_0x5676f1(0x139)](_0xb6217, _0x215ef0);
            }
            _0x2adbc2[_0x58251f(0xeb)](_0x57298e, (_0x354243 = _0x354243[_0x58251f(0x11f)](_0x6f19e1, _0x4d6ab9 || []))[_0x58251f(0x110)]());
        });
    }, __importDefault = this && this[_0x6ffcab(0x148) + _0x6ffcab(0x146)] || function (_0x13a5d5) {
        const _0x4cc7fd = _0x6ffcab;
        return _0x13a5d5 && _0x13a5d5[_0x4cc7fd(0x142)] ? _0x13a5d5 : { 'default': _0x13a5d5 };
    };
const _0x3d49a3 = {};
_0x3d49a3[_0x6ffcab(0x131)] = !![], Object[_0x6ffcab(0x11a) + _0x6ffcab(0x147)](exports, _0x6ffcab(0x142), _0x3d49a3);
function _0x2a7d() {
    const _0x3a6577 = [
        'ticketId',
        'photo',
        'then',
        '\x20message\x20',
        'IqHAl',
        'sended',
        'userId',
        'TQXHL',
        'ZPRO',
        '_SYSTEM\x202',
        ':::\x20WHATITAN\x20::',
        '__esModule',
        'uuid',
        'WNnCS',
        'log',
        'fault',
        'erty',
        '__importDe',
        'ls/Message',
        'throw',
        '186183vbuSoP',
        'name',
        'where',
        'Znhzi',
        'read',
        '11854JzZPVI',
        '../../zltz',
        'create',
        'type',
        'warn',
        'CyltF',
        '21hHWpmT',
        'VHOYh',
        'length',
        'ls/TicketZ',
        'include',
        'UmBtY',
        'ERR_CREATI',
        'rGHex',
        'ls/Contact',
        'BKOeK',
        'tnUxE',
        'mediaType',
        'status',
        '../../qozl',
        'done',
        'hq_zpro/fx',
        'NG_MESSAGE',
        'nEOGW',
        'MMMrB',
        'error',
        ':::\x20WHATITAN\x20',
        'update',
        'getTime',
        'contactId',
        'RNPpo',
        'ack',
        'lasfz',
        'PRO',
        '510828ogEPqU',
        ':\x20Creating',
        'GhuZr',
        '490560FHSlZZ',
        '5563680xIWart',
        'hsixG',
        '20wPEVkU',
        'NVdin',
        'timestamp',
        'payload',
        'ge1r_zpro/',
        '../../mode',
        'QdkbA',
        '6017076qNxBWa',
        '89GGfeUO',
        'findOne',
        'LzJui',
        'findByPk',
        'ls/UserZPR',
        'next',
        '1339008mKTnzO',
        ':\x20e8',
        'scheduleDa',
        'ticket',
        'khyVO',
        'idFront',
        'xists',
        'chat:creat',
        'logger',
        'defineProp',
        'mediaUrl',
        'user',
        'nJYIc',
        'npjYP',
        'apply',
        'model',
        'Fsaum',
        'quotedMsg',
        'fromMe',
        'toString',
        'default',
        'QOxXX',
        'xbj_zpro',
        'messageId',
        'image',
        'iui_zpro',
        'info',
        '__awaiter',
        'ihuPM',
        'khMuM',
        'NvypO',
        'body',
        'value',
        'tenantId',
        '\x20message\x20e',
        'contact',
        'KcezI',
        'LQlZL'
    ];
    _0x2a7d = function () {
        return _0x3a6577;
    };
    return _0x2a7d();
}
const MessageZPRO_1 = __importDefault(require(_0x6ffcab(0x108) + _0x6ffcab(0x149) + _0x6ffcab(0x13f))), fxiui_zpro_1 = require(_0x6ffcab(0xee) + _0x6ffcab(0xf0) + _0x6ffcab(0x12a)), xbj_zpro_1 = __importDefault(require(_0x6ffcab(0x151) + _0x6ffcab(0x107) + _0x6ffcab(0x127))), uuid_1 = require(_0x6ffcab(0x143)), TicketZPRO_1 = __importDefault(require(_0x6ffcab(0x108) + _0x6ffcab(0xe4) + _0x6ffcab(0xfc))), UserZPRO_1 = __importDefault(require(_0x6ffcab(0x108) + _0x6ffcab(0x10f) + 'O')), ContactZPRO_1 = __importDefault(require(_0x6ffcab(0x108) + _0x6ffcab(0xe9) + _0x6ffcab(0x13f))), CreateMessageService = _0x519e43 => __awaiter(void (0x1a31 + -0x1883 + 0x56 * -0x5), void (0x13eb + -0x2131 + 0xd46), void (0x1f34 + 0x1a6f + -0xd * 0x46f), function* () {
        const _0x46ca26 = _0x6ffcab, _0x596529 = {};
        _0x596529[_0x46ca26(0xe6)] = _0x46ca26(0xf5) + _0x46ca26(0x141) + _0x46ca26(0xfe) + _0x46ca26(0x13a), _0x596529[_0x46ca26(0xf9)] = _0x46ca26(0xf5) + _0x46ca26(0x141) + _0x46ca26(0xfe) + _0x46ca26(0x133) + _0x46ca26(0x117), _0x596529[_0x46ca26(0x10d)] = function (_0x2920c1, _0x48d464) {
            return _0x2920c1 === _0x48d464;
        }, _0x596529[_0x46ca26(0x126)] = _0x46ca26(0x13c), _0x596529[_0x46ca26(0x115)] = function (_0xb8ea67, _0x3ddb51) {
            return _0xb8ea67 === _0x3ddb51;
        }, _0x596529[_0x46ca26(0x136)] = _0x46ca26(0x138), _0x596529[_0x46ca26(0xfb)] = _0x46ca26(0x129), _0x596529[_0x46ca26(0xff)] = _0x46ca26(0x114), _0x596529[_0x46ca26(0xf2)] = _0x46ca26(0x134), _0x596529[_0x46ca26(0x109)] = _0x46ca26(0x122), _0x596529[_0x46ca26(0x12e)] = _0x46ca26(0x11c), _0x596529[_0x46ca26(0xe8)] = _0x46ca26(0x14c), _0x596529[_0x46ca26(0x135)] = function (_0x54b570, _0x108779) {
            return _0x54b570 >= _0x108779;
        }, _0x596529[_0x46ca26(0x14e)] = function (_0x2e762d, _0x5cb57f) {
            return _0x2e762d === _0x5cb57f;
        }, _0x596529[_0x46ca26(0x13e)] = _0x46ca26(0xf4), _0x596529[_0x46ca26(0xf3)] = _0x46ca26(0xe7) + _0x46ca26(0xf1) + _0x46ca26(0x140), _0x596529[_0x46ca26(0x11e)] = function (_0x358907, _0x447fbf) {
            return _0x358907 >= _0x447fbf;
        }, _0x596529[_0x46ca26(0x157)] = function (_0x5e3abd, _0x22f319) {
            return _0x5e3abd === _0x22f319;
        }, _0x596529[_0x46ca26(0x102)] = function (_0x566587, _0x57fd70) {
            return _0x566587 === _0x57fd70;
        }, _0x596529[_0x46ca26(0x104)] = _0x46ca26(0x118) + 'e', _0x596529[_0x46ca26(0x12d)] = function (_0x407c8, _0x3cd3f5) {
            return _0x407c8 + _0x3cd3f5;
        }, _0x596529[_0x46ca26(0x144)] = _0x46ca26(0xf5) + _0x46ca26(0x141) + _0x46ca26(0x112);
        const _0x3e779f = _0x596529;
        var _0x33ce24, _0x5c41b8;
        fxiui_zpro_1[_0x46ca26(0x119)][_0x46ca26(0x12b)](_0x3e779f[_0x46ca26(0xe6)]);
        const _0x3fc598 = {};
        _0x3fc598[_0x46ca26(0x128)] = _0x519e43['id'], _0x3fc598[_0x46ca26(0x132)] = _0x519e43[_0x46ca26(0x132)];
        const _0x14e0b0 = {};
        _0x14e0b0[_0x46ca26(0x14d)] = _0x3fc598;
        const _0x18ccef = yield MessageZPRO_1[_0x46ca26(0x125)][_0x46ca26(0x10c)](_0x14e0b0);
        if (_0x18ccef) {
            fxiui_zpro_1[_0x46ca26(0x119)][_0x46ca26(0x12b)](_0x3e779f[_0x46ca26(0xf9)]);
            return;
        }
        const {
            id: _0x55659f,
            contactId: _0x57418b,
            body: _0x39d5a2,
            ticketId: _0x14d648,
            fromMe: _0x54612a,
            tenantId: _0x5148c2,
            fileName: _0x3f2557,
            mediaType: _0x38955b,
            originalName: _0x137f3d,
            scheduleDate: _0x4b9427,
            ack: _0x4c438a,
            userId: _0x49ae74
        } = _0x519e43;
        if ((!_0x39d5a2 || _0x3e779f[_0x46ca26(0x10d)](_0x39d5a2, '')) && (!_0x3f2557 || _0x3e779f[_0x46ca26(0x10d)](_0x3f2557, '')))
            return;
        const _0x3012e2 = (0x4 * 0x991 + 0x54 * 0x3d + -0x3a48, uuid_1['v4'])(), _0x5d7430 = {};
        _0x5d7430[_0x46ca26(0xf8)] = _0x57418b, _0x5d7430[_0x46ca26(0x130)] = _0x39d5a2, _0x5d7430[_0x46ca26(0x137)] = _0x14d648, _0x5d7430[_0x46ca26(0x123)] = _0x54612a, _0x5d7430[_0x46ca26(0x132)] = _0x5148c2, _0x5d7430[_0x46ca26(0x128)] = _0x55659f, _0x5d7430[_0x46ca26(0xfa)] = 0x2, _0x5d7430[_0x46ca26(0xed)] = _0x3e779f[_0x46ca26(0x126)], _0x5d7430[_0x46ca26(0x116)] = _0x3012e2, _0x5d7430[_0x46ca26(0x14f)] = ![], _0x5d7430[_0x46ca26(0x113) + 'te'] = _0x4b9427, _0x5d7430[_0x46ca26(0x13d)] = _0x49ae74;
        const _0x58076b = _0x5d7430;
        _0x3f2557 && (_0x58076b[_0x46ca26(0x11b)] = _0x3f2557, _0x58076b[_0x46ca26(0xec)] = _0x3e779f[_0x46ca26(0x115)](_0x38955b, _0x3e779f[_0x46ca26(0x136)]) ? _0x3e779f[_0x46ca26(0xfb)] : _0x38955b);
        try {
            const _0x5ac3b = yield MessageZPRO_1[_0x46ca26(0x125)][_0x46ca26(0x152)](_0x58076b), _0x2e687b = {};
            _0x2e687b[_0x46ca26(0x132)] = _0x5148c2;
            const _0x4ee1ba = {};
            _0x4ee1ba[_0x46ca26(0x120)] = TicketZPRO_1[_0x46ca26(0x125)], _0x4ee1ba['as'] = _0x3e779f[_0x46ca26(0xff)], _0x4ee1ba[_0x46ca26(0x14d)] = _0x2e687b, _0x4ee1ba[_0x46ca26(0xe5)] = [_0x3e779f[_0x46ca26(0xf2)]];
            const _0x49870b = yield MessageZPRO_1[_0x46ca26(0x125)][_0x46ca26(0x10e)](_0x5ac3b['id'], {
                'include': [
                    _0x4ee1ba,
                    {
                        'model': MessageZPRO_1[_0x46ca26(0x125)],
                        'as': _0x3e779f[_0x46ca26(0x109)],
                        'include': [_0x3e779f[_0x46ca26(0xf2)]]
                    },
                    {
                        'model': UserZPRO_1[_0x46ca26(0x125)],
                        'as': _0x3e779f[_0x46ca26(0x12e)],
                        'attributes': [
                            'id',
                            _0x3e779f[_0x46ca26(0xe8)]
                        ]
                    },
                    {
                        'model': ContactZPRO_1[_0x46ca26(0x125)],
                        'as': _0x3e779f[_0x46ca26(0xf2)],
                        'attributes': [
                            'id',
                            _0x3e779f[_0x46ca26(0xe8)]
                        ]
                    }
                ]
            });
            if (_0x49870b)
                try {
                    yield _0x49870b[_0x46ca26(0x114)][_0x46ca26(0xf6)]({
                        'lastMessageAt': _0x3e779f[_0x46ca26(0x135)](_0x3e779f[_0x46ca26(0x10d)](_0x33ce24 = _0x49870b[_0x46ca26(0x105)], null) || _0x3e779f[_0x46ca26(0x14e)](_0x33ce24, void (-0x1 * 0x2078 + 0x2 * 0xf0d + 0x25e)) ? void (-0x7 * 0x4bd + -0xd54 * 0x1 + -0x2e7f * -0x1) : _0x33ce24[_0x46ca26(0x124)]()[_0x46ca26(0xe3)], 0x4c3 + -0xffe * 0x1 + -0xb48 * -0x1) ? _0x49870b[_0x46ca26(0x105)] : new Date()[_0x46ca26(0xf7)](),
                        'lastMessageReceived': _0x49870b[_0x46ca26(0x123)] ? null : new Date()[_0x46ca26(0xf7)]()
                    });
                } catch (_0x35e8ba) {
                    console[_0x46ca26(0x145)](_0x3e779f[_0x46ca26(0x13e)], _0x35e8ba);
                }
            if (!_0x49870b)
                throw new Error(_0x3e779f[_0x46ca26(0xf3)]);
            _0x49870b[_0x46ca26(0x123)] && (yield TicketZPRO_1[_0x46ca26(0x125)][_0x46ca26(0xf6)]({ 'lastMessageReceived': _0x3e779f[_0x46ca26(0x11e)](_0x3e779f[_0x46ca26(0x157)](_0x5c41b8 = _0x49870b[_0x46ca26(0x105)], null) || _0x3e779f[_0x46ca26(0x102)](_0x5c41b8, void (-0x1 * 0x1f + 0x1 * -0x653 + -0x1e * -0x37)) ? void (0x1b61 + -0x1d86 + 0x225) : _0x5c41b8[_0x46ca26(0x124)]()[_0x46ca26(0xe3)], 0x26e * 0x10 + 0xc53 + -0x3326 * 0x1) ? _0x49870b[_0x46ca26(0x105)] : new Date()[_0x46ca26(0xf7)]() }, { 'where': { 'id': _0x49870b[_0x46ca26(0x137)] } }));
            const _0x5016c8 = {};
            return _0x5016c8[_0x46ca26(0x132)] = _0x5148c2, _0x5016c8[_0x46ca26(0x153)] = _0x3e779f[_0x46ca26(0x104)], _0x5016c8[_0x46ca26(0x106)] = _0x49870b, (-0x4 * -0x4cc + -0xd31 + 0x5 * -0x133, xbj_zpro_1[_0x46ca26(0x125)])(_0x5016c8), _0x5ac3b;
        } catch (_0x13b520) {
            fxiui_zpro_1[_0x46ca26(0x119)][_0x46ca26(0x154)](_0x3e779f[_0x46ca26(0x12d)](_0x3e779f[_0x46ca26(0x144)], _0x13b520));
        }
    });
exports[_0x6ffcab(0x125)] = CreateMessageService;