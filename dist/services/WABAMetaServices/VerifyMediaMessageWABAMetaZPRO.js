'use strict';
function _0xba69(_0x24c0f9, _0x268c2d) {
    const _0x3046fd = _0x454a();
    return _0xba69 = function (_0x525b2f, _0x593257) {
        _0x525b2f = _0x525b2f - (-0x757 * -0x1 + -0xe8a + 0x808);
        let _0x4bf878 = _0x3046fd[_0x525b2f];
        return _0x4bf878;
    }, _0xba69(_0x24c0f9, _0x268c2d);
}
const _0x1d5a70 = _0xba69;
(function (_0x4cfbe1, _0x36d79f) {
    const _0x447ad2 = _0xba69, _0x58cf44 = _0x4cfbe1();
    while (!![]) {
        try {
            const _0xf4cd42 = -parseInt(_0x447ad2(0x155)) / (-0x1 * -0x19dc + 0x1 * -0x1935 + -0x1 * 0xa6) * (parseInt(_0x447ad2(0x14c)) / (-0xdc5 + 0x18b6 + 0x3 * -0x3a5)) + parseInt(_0x447ad2(0xed)) / (-0xf08 + 0x14e * 0x1 + 0xdbd) * (parseInt(_0x447ad2(0xf2)) / (0x1 * 0xe59 + -0x25bb + 0x1766)) + -parseInt(_0x447ad2(0x165)) / (-0x25cc * 0x1 + -0x1112 + -0x36e3 * -0x1) + -parseInt(_0x447ad2(0x144)) / (-0x225a + 0x21a7 + -0xb9 * -0x1) * (parseInt(_0x447ad2(0xdb)) / (-0x134f * 0x2 + 0x1c16 + -0x33 * -0x35)) + parseInt(_0x447ad2(0x141)) / (-0x1744 + 0x1298 + 0x4 * 0x12d) + parseInt(_0x447ad2(0x10a)) / (-0x1 * 0x29f + 0x45 * 0x6 + 0x10a) + parseInt(_0x447ad2(0x111)) / (0x1 * -0xcb3 + 0xc80 + 0x3d) * (parseInt(_0x447ad2(0x125)) / (-0x1311 * 0x2 + 0x803 + -0xc6 * -0x27));
            if (_0xf4cd42 === _0x36d79f)
                break;
            else
                _0x58cf44['push'](_0x58cf44['shift']());
        } catch (_0x45b925) {
            _0x58cf44['push'](_0x58cf44['shift']());
        }
    }
}(_0x454a, -0x1 * -0x145df + -0x66 * 0x943 + -0x101 * -0xe3f));
var __awaiter = this && this[_0x1d5a70(0xec)] || function (_0x19a798, _0x10a0c0, _0x1b6076, _0x1127e8) {
        const _0x1a9c31 = _0x1d5a70, _0x29d73e = {
                'GQQrE': function (_0x1ec49b, _0x31b1ad) {
                    return _0x1ec49b(_0x31b1ad);
                },
                'dTojj': function (_0x418e67, _0x270c78) {
                    return _0x418e67 instanceof _0x270c78;
                },
                'SZmgr': function (_0x29ef9b, _0x791d3) {
                    return _0x29ef9b(_0x791d3);
                },
                'EGPhK': function (_0x460768, _0xfce64e) {
                    return _0x460768(_0xfce64e);
                },
                'bgeTe': _0x1a9c31(0x130),
                'MjQha': function (_0x2b8ac3, _0xa01625) {
                    return _0x2b8ac3(_0xa01625);
                },
                'MzOfZ': function (_0x9e429c, _0x355bba) {
                    return _0x9e429c(_0x355bba);
                }
            };
        function _0x5e4350(_0x5ca167) {
            const _0x42520d = _0x1a9c31, _0x435e35 = {
                    'rKsoK': function (_0x54f7d6, _0x1fd53e) {
                        const _0x4f7f76 = _0xba69;
                        return _0x29d73e[_0x4f7f76(0x10f)](_0x54f7d6, _0x1fd53e);
                    }
                };
            return _0x29d73e[_0x42520d(0x139)](_0x5ca167, _0x1b6076) ? _0x5ca167 : new _0x1b6076(function (_0x898802) {
                const _0x3742c3 = _0x42520d;
                _0x435e35[_0x3742c3(0x154)](_0x898802, _0x5ca167);
            });
        }
        return new (_0x1b6076 || (_0x1b6076 = Promise))(function (_0x36ae0c, _0x5208f2) {
            const _0x48ac34 = _0x1a9c31, _0x57648c = {
                    'srgGo': function (_0x42b261, _0x10c3d3) {
                        const _0x4f7880 = _0xba69;
                        return _0x29d73e[_0x4f7880(0x15a)](_0x42b261, _0x10c3d3);
                    },
                    'WAbck': _0x29d73e[_0x48ac34(0xfb)],
                    'Szpwe': function (_0x503a3e, _0x4a2e5c) {
                        const _0x2f7ead = _0x48ac34;
                        return _0x29d73e[_0x2f7ead(0x167)](_0x503a3e, _0x4a2e5c);
                    }
                };
            function _0x1844ce(_0x37700c) {
                const _0x48a3bf = _0x48ac34;
                try {
                    _0x57648c[_0x48a3bf(0xf6)](_0xb907ae, _0x1127e8[_0x48a3bf(0x14f)](_0x37700c));
                } catch (_0x20f666) {
                    _0x57648c[_0x48a3bf(0xf6)](_0x5208f2, _0x20f666);
                }
            }
            function _0x4c68ec(_0x4609d4) {
                const _0xa862c2 = _0x48ac34;
                try {
                    _0x57648c[_0xa862c2(0xf6)](_0xb907ae, _0x1127e8[_0x57648c[_0xa862c2(0xd8)]](_0x4609d4));
                } catch (_0x34e0f8) {
                    _0x57648c[_0xa862c2(0x163)](_0x5208f2, _0x34e0f8);
                }
            }
            function _0xb907ae(_0x3465ba) {
                const _0x5204c5 = _0x48ac34;
                _0x3465ba[_0x5204c5(0xe1)] ? _0x29d73e[_0x5204c5(0xd6)](_0x36ae0c, _0x3465ba[_0x5204c5(0x101)]) : _0x29d73e[_0x5204c5(0x10f)](_0x5e4350, _0x3465ba[_0x5204c5(0x101)])[_0x5204c5(0x138)](_0x1844ce, _0x4c68ec);
            }
            _0x29d73e[_0x48ac34(0x12a)](_0xb907ae, (_0x1127e8 = _0x1127e8[_0x48ac34(0x135)](_0x19a798, _0x10a0c0 || []))[_0x48ac34(0x14f)]());
        });
    }, __importDefault = this && this[_0x1d5a70(0xea) + _0x1d5a70(0xe2)] || function (_0x5717ca) {
        const _0x57fbee = _0x1d5a70;
        return _0x5717ca && _0x5717ca[_0x57fbee(0x11a)] ? _0x5717ca : { 'default': _0x5717ca };
    };
const _0x52059f = {};
function _0x454a() {
    const _0x1ed128 = [
        'dTojj',
        'cess\x20succe',
        'webhook',
        '3s0z5_zpro',
        'ookService',
        ':\x20enviarWe',
        'messageId',
        'qLqIk',
        '5892488svNFCV',
        'ciKAG',
        'error',
        '6EtksHk',
        'BACKEND_UR',
        'update',
        'qzehW',
        'JfADF',
        'caption',
        'g\x204:\x20',
        'getTime',
        '2oLMERd',
        'erty',
        'has',
        'next',
        'defineProp',
        'key',
        'timestamp',
        'ng\x20WABA\x20ms',
        'rKsoK',
        '918644dyWRmf',
        'node-cache',
        './WABAMeta',
        '../../xwsp',
        '../Message',
        'EGPhK',
        'jqWQY',
        'fromMe',
        './GetMedia',
        'geServiceZ',
        ':\x20Waba\x20pro',
        ':\x20WABA\x20msg',
        'messageDat',
        '/public/',
        'Szpwe',
        'findOne',
        '3274275EFWqNg',
        ':::\x20WhaTitan\x20::',
        'MjQha',
        'PRO',
        'msg',
        ':::\x20WhaTitan\x20',
        '/ye0esz516',
        'SZmgr',
        'IYlbV',
        'WAbck',
        '_zpro',
        'r\x204:\x20',
        '8762082zVRIGV',
        'env',
        'attributes',
        'warn',
        'dTLWN',
        'stdTTL',
        'done',
        'fault',
        'VnhzK',
        'uovqo',
        'enabled',
        'vCwhu',
        'sended',
        'enviarWebh',
        'type',
        '__importDe',
        'rocessed\x204',
        '__awaiter',
        '173361txEuzc',
        'tenantId',
        'default',
        'HandleWebh',
        'set',
        '52MuYOBL',
        'text',
        'body',
        'ticket',
        'srgGo',
        'findAll',
        'zpro',
        'template',
        'Iijcy',
        'bgeTe',
        'received',
        'posxjtgen_',
        'reateMessa',
        'r:\x20',
        'c8_zpro/wa',
        'value',
        'Mensagem\x20j',
        'WABAMetaZP',
        'VnJMV',
        '../../ludp',
        'รก\x20processa',
        'chat',
        'channel',
        'logger',
        '8703504IAIKRd',
        'QCXZj',
        'reduce',
        'n8nStatus',
        'Services/C',
        'GQQrE',
        'rxeiX',
        '11492370wQNNiq',
        'webhookMes',
        'info',
        'qBbRj',
        'ZPRO',
        '\x20already\x20p',
        'DhDzr',
        'RiqRC',
        'qkTiT',
        '__esModule',
        'webhookUrl',
        'sage',
        'ls/Setting',
        'fALiJ',
        'ls/Message',
        'qWYcT',
        'includes',
        'ook',
        'ate',
        'assign',
        '11YYrCIW',
        'da\x204:\x20',
        'oMdFN',
        'payload',
        ':\x20\x20WABA\x20pr',
        'MzOfZ',
        ':\x20Processi',
        'QvHnj',
        'anYZc',
        'n8n',
        'ticket:upd',
        'throw',
        'ss\x204:\x20',
        'where',
        'ookN8N',
        '../../mode',
        'apply',
        'ocess\x20erro',
        'bhook\x20erro',
        'then'
    ];
    _0x454a = function () {
        return _0x1ed128;
    };
    return _0x454a();
}
_0x52059f[_0x1d5a70(0x101)] = !![], Object[_0x1d5a70(0x150) + _0x1d5a70(0x14d)](exports, _0x1d5a70(0x11a), _0x52059f);
const MessageZPRO_1 = __importDefault(require(_0x1d5a70(0x134) + _0x1d5a70(0x11f) + _0x1d5a70(0x115))), CreateMessageServiceZPRO_1 = __importDefault(require(_0x1d5a70(0x159) + _0x1d5a70(0x10e) + _0x1d5a70(0xfe) + _0x1d5a70(0x15e) + _0x1d5a70(0x168))), GetMediaWABAMetaZPRO_1 = __importDefault(require(_0x1d5a70(0x15d) + _0x1d5a70(0x103) + 'RO')), waposxjtgen_zpro_1 = __importDefault(require(_0x1d5a70(0x105) + _0x1d5a70(0x100) + _0x1d5a70(0xfd) + _0x1d5a70(0xf8))), WABAMetaHandleWebhookServiceZPRO_1 = require(_0x1d5a70(0x157) + _0x1d5a70(0xf0) + _0x1d5a70(0x13d) + _0x1d5a70(0x115)), ye0esz516_zpro_1 = require(_0x1d5a70(0x158) + _0x1d5a70(0x13c) + _0x1d5a70(0xd5) + _0x1d5a70(0xd9)), SettingZPRO_1 = __importDefault(require(_0x1d5a70(0x134) + _0x1d5a70(0x11d) + _0x1d5a70(0x115))), node_cache_1 = __importDefault(require(_0x1d5a70(0x156)));
function extractCaption(_0x34d0dd) {
    const _0x413e71 = _0x1d5a70;
    if (!_0x34d0dd || !_0x34d0dd[_0x413e71(0xe9)])
        return '';
    const _0x4f327d = _0x34d0dd[_0x34d0dd[_0x413e71(0xe9)]];
    if (_0x4f327d && _0x4f327d[_0x413e71(0x149)])
        return _0x4f327d[_0x413e71(0x149)];
    return '';
}
const VerifyMediaMessage = (_0x4b7cec, _0x5ecd16, _0x1974ac, _0x466d67) => __awaiter(void (-0x7f * -0x3b + -0x6d7 * -0x1 + -0x4 * 0x907), void (0x18fd * -0x1 + 0x144a + -0x1 * -0x4b3), void (-0xa9 * -0x1 + -0x30f + -0x266 * -0x1), function* () {
    const _0x191dd0 = _0x1d5a70, _0x27d032 = {
            'anYZc': _0x191dd0(0x13f),
            'oMdFN': _0x191dd0(0xf3),
            'QCXZj': _0x191dd0(0x107),
            'dTLWN': _0x191dd0(0xf9),
            'qLqIk': function (_0x359d09, _0x2554eb) {
                return _0x359d09(_0x2554eb);
            },
            'QvHnj': _0x191dd0(0xe7),
            'uovqo': _0x191dd0(0xfc),
            'JfADF': function (_0x448a3c, _0x5ae4d4) {
                return _0x448a3c + _0x5ae4d4;
            },
            'VnhzK': function (_0x930ab1, _0x10f17d) {
                return _0x930ab1 + _0x10f17d;
            },
            'qzehW': function (_0x260941, _0x3226cc) {
                return _0x260941 + _0x3226cc;
            },
            'DhDzr': function (_0x1e148a, _0x41f9ce) {
                return _0x1e148a + _0x41f9ce;
            },
            'IYlbV': _0x191dd0(0x162),
            'rxeiX': _0x191dd0(0x112) + _0x191dd0(0x11c),
            'fALiJ': _0x191dd0(0x11b),
            'jqWQY': _0x191dd0(0x13b),
            'qWYcT': _0x191dd0(0x12e),
            'vCwhu': function (_0x5dffa5, _0x5173fd) {
                return _0x5dffa5 === _0x5173fd;
            },
            'Iijcy': _0x191dd0(0xe5),
            'qBbRj': function (_0x1ddd53, _0x376e3c) {
                return _0x1ddd53 + _0x376e3c;
            },
            'qkTiT': _0x191dd0(0x16a) + _0x191dd0(0x166) + _0x191dd0(0x13e) + _0x191dd0(0x137) + _0x191dd0(0xff),
            'RiqRC': function (_0x54a08b, _0x17c3a5) {
                return _0x54a08b === _0x17c3a5;
            },
            'ciKAG': function (_0x435361, _0x1da19a) {
                return _0x435361 === _0x1da19a;
            },
            'VnJMV': _0x191dd0(0x12f) + _0x191dd0(0x123)
        };
    var _0x5ac0e3;
    const _0x484617 = {};
    _0x484617[_0x191dd0(0xe0)] = 0xa;
    const _0x445b95 = new node_cache_1[(_0x191dd0(0xef))](_0x484617), _0x5dda9b = _0x5ecd16['id'];
    if (!_0x5dda9b)
        return;
    if (_0x445b95[_0x191dd0(0x14e)](_0x5dda9b)) {
        ye0esz516_zpro_1[_0x191dd0(0x109)][_0x191dd0(0x113)](_0x191dd0(0x102) + _0x191dd0(0x106) + _0x191dd0(0x126) + _0x5dda9b);
        return;
    }
    _0x445b95[_0x191dd0(0xf1)](_0x5dda9b, !![]);
    try {
        ye0esz516_zpro_1[_0x191dd0(0x109)][_0x191dd0(0x113)](_0x191dd0(0x16a) + _0x191dd0(0x166) + _0x191dd0(0x12b) + _0x191dd0(0x153) + _0x191dd0(0x14a) + _0x5dda9b);
        const _0x5842ef = {};
        _0x5842ef[_0x191dd0(0x13f)] = _0x5dda9b, _0x5842ef[_0x191dd0(0xee)] = _0x1974ac[_0x191dd0(0xee)];
        const _0x277b59 = {};
        _0x277b59[_0x191dd0(0x132)] = _0x5842ef, _0x277b59[_0x191dd0(0xdd)] = [
            'id',
            _0x27d032[_0x191dd0(0x12d)]
        ];
        const _0x4eecca = yield MessageZPRO_1[_0x191dd0(0xef)][_0x191dd0(0x164)](_0x277b59);
        if (_0x4eecca) {
            ye0esz516_zpro_1[_0x191dd0(0x109)][_0x191dd0(0x113)](_0x191dd0(0x16a) + _0x191dd0(0x166) + _0x191dd0(0x160) + _0x191dd0(0x116) + _0x191dd0(0xeb) + ':\x20' + _0x5dda9b);
            return;
        }
        ye0esz516_zpro_1[_0x191dd0(0x109)][_0x191dd0(0x113)](_0x191dd0(0x16a) + _0x191dd0(0x166) + _0x191dd0(0x15f) + _0x191dd0(0x13a) + _0x191dd0(0x131) + _0x5dda9b);
    } catch (_0x466fa4) {
        ye0esz516_zpro_1[_0x191dd0(0x109)][_0x191dd0(0x143)](_0x191dd0(0x16a) + _0x191dd0(0x166) + _0x191dd0(0x129) + _0x191dd0(0x136) + _0x191dd0(0xda) + _0x5dda9b, _0x466fa4);
    }
    let _0x566bf3;
    try {
        const _0x3ea70b = {};
        _0x3ea70b[_0x191dd0(0x108)] = _0x4b7cec, _0x3ea70b[_0x191dd0(0x169)] = _0x5ecd16, _0x3ea70b[_0x191dd0(0xf5)] = _0x1974ac, _0x566bf3 = yield (-0xfa7 + 0x1320 + -0x379, GetMediaWABAMetaZPRO_1[_0x191dd0(0xef)])(_0x3ea70b);
    } catch (_0x63a1cc) {
    }
    let _0x41449a;
    if (![
            _0x27d032[_0x191dd0(0x127)],
            _0x27d032[_0x191dd0(0x10b)],
            _0x27d032[_0x191dd0(0xdf)]
        ][_0x191dd0(0x121)](_0x5ecd16[_0x191dd0(0xe9)])) {
        const _0x40e66b = _0x5ecd16;
        _0x41449a = _0x40e66b[_0x5ecd16[_0x191dd0(0xe9)]]['id'];
    }
    const _0x27edfd = {
            'messageId': _0x5ecd16['id'] || '',
            'ticketId': _0x1974ac['id'],
            'contactId': _0x5ecd16[_0x191dd0(0x15c)] ? undefined : _0x466d67['id'],
            'body': _0x27d032[_0x191dd0(0x140)](extractCaption, _0x5ecd16) || _0x566bf3 || '',
            'fromMe': _0x5ecd16[_0x191dd0(0x15c)],
            'read': _0x5ecd16[_0x191dd0(0x15c)],
            'mediaUrl': _0x566bf3,
            'mediaType': _0x5ecd16[_0x191dd0(0xe9)],
            'timestamp': +_0x5ecd16[_0x191dd0(0x152)],
            'wabaMediaId': _0x41449a,
            'status': _0x5ecd16[_0x191dd0(0x15c)] ? _0x27d032[_0x191dd0(0x12c)] : _0x27d032[_0x191dd0(0xe4)]
        }, _0x4524bf = Object[_0x191dd0(0x124)](Object[_0x191dd0(0x124)]({}, _0x27edfd), { 'mediaUrl': _0x27d032[_0x191dd0(0x148)](_0x27d032[_0x191dd0(0xe3)](_0x27d032[_0x191dd0(0x147)](_0x27d032[_0x191dd0(0x117)](process[_0x191dd0(0xdc)][_0x191dd0(0x145) + 'L'], _0x27d032[_0x191dd0(0xd7)]), _0x1974ac[_0x191dd0(0xee)]), '/'), _0x566bf3) });
    try {
        const _0xe1fc3c = [
                _0x27d032[_0x191dd0(0x110)],
                _0x27d032[_0x191dd0(0x11e)],
                _0x27d032[_0x191dd0(0x15b)]
            ], _0x343a7f = {};
        _0x343a7f[_0x191dd0(0x151)] = _0xe1fc3c, _0x343a7f[_0x191dd0(0xee)] = _0x1974ac[_0x191dd0(0xee)];
        const _0x2dea3f = {};
        _0x2dea3f[_0x191dd0(0x132)] = _0x343a7f;
        const _0x2bc007 = yield SettingZPRO_1[_0x191dd0(0xef)][_0x191dd0(0xf7)](_0x2dea3f), _0x106420 = _0x2bc007[_0x191dd0(0x10c)]((_0x62a0dd, _0x1a731c) => {
                const _0x1450ab = _0x191dd0;
                return _0x62a0dd[_0x1a731c[_0x1450ab(0x151)]] = _0x1a731c, _0x62a0dd;
            }, {}), _0x5f0ad1 = _0x106420[_0x27d032[_0x191dd0(0x110)]], _0x21cc4e = _0x106420[_0x27d032[_0x191dd0(0x11e)]], _0xd5f9b1 = _0x106420[_0x27d032[_0x191dd0(0x15b)]], _0x2312b2 = _0x106420[_0x27d032[_0x191dd0(0x120)]];
        yield (0x1d6 * -0xa + -0xe88 + -0x839 * -0x4, WABAMetaHandleWebhookServiceZPRO_1[_0x191dd0(0xe8) + _0x191dd0(0x122)])(_0x27edfd, _0x1974ac[_0x191dd0(0xee)], _0x1974ac, _0xd5f9b1, _0x21cc4e, _0x5f0ad1), _0x2312b2 && _0x27d032[_0x191dd0(0xe6)](_0x27d032[_0x191dd0(0xe6)](_0x2312b2, null) || _0x27d032[_0x191dd0(0xe6)](_0x2312b2, void (0x2692 + 0x1 * -0xc83 + -0x1a0f)) ? void (0x171e + 0x26ea * 0x1 + 0x4 * -0xf82) : _0x2312b2[_0x191dd0(0x101)], _0x27d032[_0x191dd0(0xfa)]) && _0x1974ac[_0x191dd0(0x10d)] && (yield (0xa66 + -0x12d5 * -0x1 + 0x1 * -0x1d3b, WABAMetaHandleWebhookServiceZPRO_1[_0x191dd0(0xe8) + _0x191dd0(0x133)])(_0x4524bf, _0x1974ac, _0x4b7cec));
    } catch (_0x1bc223) {
        ye0esz516_zpro_1[_0x191dd0(0x109)][_0x191dd0(0xde)](_0x27d032[_0x191dd0(0x114)](_0x27d032[_0x191dd0(0x119)], _0x1bc223));
    }
    yield _0x1974ac[_0x191dd0(0x146)]({
        'lastMessage': (_0x27d032[_0x191dd0(0x118)](_0x5ac0e3 = _0x27d032[_0x191dd0(0x142)](_0x5ecd16, null) || _0x27d032[_0x191dd0(0x142)](_0x5ecd16, void (-0x1b67 + 0x25 * -0x5f + 0x2922)) ? void (-0x10cc + -0x1a30 * 0x1 + 0x7 * 0x624) : _0x5ecd16[_0x191dd0(0xf3)], null) || _0x27d032[_0x191dd0(0x118)](_0x5ac0e3, void (0x3 * -0x90c + 0x1d95 * -0x1 + 0x38b9)) ? void (-0x2638 + 0x5 * -0x1c1 + 0x2efd) : _0x5ac0e3[_0x191dd0(0xf4)]) || _0x566bf3,
        'lastMessageAt': new Date()[_0x191dd0(0x14b)](),
        'answered': _0x5ecd16[_0x191dd0(0x15c)] || ![],
        'lastMessageReceived': _0x5ecd16[_0x191dd0(0x15c)] ? null : new Date()[_0x191dd0(0x14b)]()
    });
    const _0x3cd8bc = {};
    _0x3cd8bc[_0x191dd0(0x161) + 'a'] = _0x27edfd, _0x3cd8bc[_0x191dd0(0xee)] = _0x1974ac[_0x191dd0(0xee)];
    const _0x5b36ad = yield (-0xee * -0x17 + -0x1c0a + -0xc * -0x8e, CreateMessageServiceZPRO_1[_0x191dd0(0xef)])(_0x3cd8bc), _0x5714e7 = {};
    return _0x5714e7[_0x191dd0(0xee)] = _0x1974ac[_0x191dd0(0xee)], _0x5714e7[_0x191dd0(0xe9)] = _0x27d032[_0x191dd0(0x104)], _0x5714e7[_0x191dd0(0x128)] = _0x1974ac, (0x25c4 + -0xc92 + -0x1932, waposxjtgen_zpro_1[_0x191dd0(0xef)])(_0x5714e7), _0x5b36ad;
});
exports[_0x1d5a70(0xef)] = VerifyMediaMessage;